{"ast":null,"code":"// context/AuthContext.js\nimport{createContext,useState,useContext,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{fetch('http://localhost:5001/api/me',{credentials:'include'}).then(res=>{if(!res.ok)throw new Error('Unauthorized');return res.json();}).then(data=>{setUser(data);localStorage.setItem('user',JSON.stringify(data));}).catch(()=>{setUser(null);localStorage.removeItem('user');}).finally(()=>setLoading(false));},[]);const login=dUser=>{setUser(dUser);localStorage.setItem('user',JSON.stringify(dUser));};const logout=async()=>{try{await fetch('http://localhost:5001/auth/logout',{method:'GET',credentials:'include'});}catch(err){console.error('Logout error:',err);}finally{setUser(null);localStorage.removeItem('user');}};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,login,logout},children:!loading&&children});};export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["createContext","useState","useContext","useEffect","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","loading","setLoading","fetch","credentials","then","res","ok","Error","json","data","localStorage","setItem","JSON","stringify","catch","removeItem","finally","login","dUser","logout","method","err","console","error","Provider","value","useAuth"],"sources":["C:/Users/admin/Videos/As13.ai/client/src/context/AuthContext.jsx"],"sourcesContent":["// context/AuthContext.js\nimport { createContext, useState, useContext, useEffect } from 'react';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetch('http://localhost:5001/api/me', {\n      credentials: 'include',\n    })\n      .then((res) => {\n        if (!res.ok) throw new Error('Unauthorized');\n        return res.json();\n      })\n      .then((data) => {\n        setUser(data);\n        localStorage.setItem('user', JSON.stringify(data));\n      })\n      .catch(() => {\n        setUser(null);\n        localStorage.removeItem('user');\n      })\n      .finally(() => setLoading(false));\n  }, []);\n\n  const login = (dUser) => {\n    setUser(dUser);\n    localStorage.setItem('user', JSON.stringify(dUser));\n  };\n\n  const logout = async () => {\n    try {\n      await fetch('http://localhost:5001/auth/logout', {\n        method: 'GET',\n        credentials: 'include',\n      });\n    } catch (err) {\n      console.error('Logout error:', err);\n    } finally {\n      setUser(null);\n      localStorage.removeItem('user');\n    }\n  };\n\n  return (\n    <AuthContext.Provider value={{ user, login, logout }}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => useContext(AuthContext);\n"],"mappings":"AAAA;AACA,OAASA,aAAa,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvE,MAAO,MAAM,CAAAC,WAAW,cAAGN,aAAa,CAAC,CAAC,CAE1C,MAAO,MAAM,CAAAO,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGV,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACW,OAAO,CAAEC,UAAU,CAAC,CAAGZ,QAAQ,CAAC,IAAI,CAAC,CAE5CE,SAAS,CAAC,IAAM,CACdW,KAAK,CAAC,8BAA8B,CAAE,CACpCC,WAAW,CAAE,SACf,CAAC,CAAC,CACCC,IAAI,CAAEC,GAAG,EAAK,CACb,GAAI,CAACA,GAAG,CAACC,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,CAAC,cAAc,CAAC,CAC5C,MAAO,CAAAF,GAAG,CAACG,IAAI,CAAC,CAAC,CACnB,CAAC,CAAC,CACDJ,IAAI,CAAEK,IAAI,EAAK,CACdV,OAAO,CAACU,IAAI,CAAC,CACbC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEC,IAAI,CAACC,SAAS,CAACJ,IAAI,CAAC,CAAC,CACpD,CAAC,CAAC,CACDK,KAAK,CAAC,IAAM,CACXf,OAAO,CAAC,IAAI,CAAC,CACbW,YAAY,CAACK,UAAU,CAAC,MAAM,CAAC,CACjC,CAAC,CAAC,CACDC,OAAO,CAAC,IAAMf,UAAU,CAAC,KAAK,CAAC,CAAC,CACrC,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAgB,KAAK,CAAIC,KAAK,EAAK,CACvBnB,OAAO,CAACmB,KAAK,CAAC,CACdR,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEC,IAAI,CAACC,SAAS,CAACK,KAAK,CAAC,CAAC,CACrD,CAAC,CAED,KAAM,CAAAC,MAAM,CAAG,KAAAA,CAAA,GAAY,CACzB,GAAI,CACF,KAAM,CAAAjB,KAAK,CAAC,mCAAmC,CAAE,CAC/CkB,MAAM,CAAE,KAAK,CACbjB,WAAW,CAAE,SACf,CAAC,CAAC,CACJ,CAAE,MAAOkB,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,eAAe,CAAEF,GAAG,CAAC,CACrC,CAAC,OAAS,CACRtB,OAAO,CAAC,IAAI,CAAC,CACbW,YAAY,CAACK,UAAU,CAAC,MAAM,CAAC,CACjC,CACF,CAAC,CAED,mBACEtB,IAAA,CAACC,WAAW,CAAC8B,QAAQ,EAACC,KAAK,CAAE,CAAE3B,IAAI,CAAEmB,KAAK,CAAEE,MAAO,CAAE,CAAAtB,QAAA,CAClD,CAACG,OAAO,EAAIH,QAAQ,CACD,CAAC,CAE3B,CAAC,CAED,MAAO,MAAM,CAAA6B,OAAO,CAAGA,CAAA,GAAMpC,UAAU,CAACI,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}